<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="William Tirtadjaja" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="William Tirtadjaja" /> <title> Decrypting and Manipulating Encrypted API Request - William Tirtadjaja </title> <link rel="alternate" href="http://localhost:4000/api-decrypt/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/api-decrypt/" /> <meta name="description" content="Feel free to explore my blog, where I share a wealth of insights on topics related to Vulnerability Assessments and Penetration Testing." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Decrypting and Manipulating Encrypted API Request | William Tirtadjaja" /> <meta property="og:title" content="Decrypting and Manipulating Encrypted API Request | William Tirtadjaja" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/api-decrypt/" /> <meta property="og:description" content="Feel free to explore my blog, where I share a wealth of insights on topics related to Vulnerability Assessments and Penetration Testing." /> <meta property="og:image" content="http://localhost:4000/%5B%22/api-decrypt/img1.PNG%22%5D" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Decrypting and Manipulating Encrypted API Request | twitter_username" /> <meta name="twitter:url" content="http://localhost:4000/api-decrypt/" /> <meta name="twitter:site" content="@twitter_username" /> <meta name="twitter:creator" content="@twitter_username" /> <meta name="twitter:description" content="Feel free to explore my blog, where I share a wealth of insights on topics related to Vulnerability Assessments and Penetration Testing." /> <meta name="twitter:image" content="http://localhost:4000/%5B%22/api-decrypt/img1.PNG%22%5D" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="William Tirtadjaja" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- for mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js?config=TeX-AMS-MML_HTMLorMML"></script> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#tips">TIPS</a>, <a class="tag" href="/tags/#web">WEB</a>, <a class="tag" href="/tags/#decryption">DECRYPTION</a> </span> </div> <h1 class="header-title" itemprop="headline">Decrypting and Manipulating Encrypted API Request</h1> <div class="post-meta"> <time datetime="2024-12-12T10:00:00+07:00" itemprop="datePublished"> Dec 12, 2024 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">William Tirtadjaja</span> </span> <time hidden datetime="" itemprop="dateModified"> Dec 12, 2024 </time> <span hidden itemprop="publisher" itemtype="Person">William Tirtadjaja</span> <span hidden itemprop="image">/api-decrypt/img1.PNG</span> <span hidden itemprop="mainEntityOfPage"><p>What if all the requests sent by the application are encrypted during the assessment, making it impossible to modify any requests during transmission? This can hinder the penetration testing process. Let’s address this issue.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>What if all the requests sent by the application are encrypted during the assessment, making it impossible to modify any requests during transmission? This can hinder the penetration testing process. Let’s address this issue.</p> <p>When an API request or response is encrypted, there will always be a client-side script responsible for the encryption process. Our task is to identify the key used in this process.</p> <p>In this demo web application, the API request will be encrypted with AES encryption. Let’s dive deeper into the client-side script to explore it further.</p> <figure> <img src="/api-decrypt/img9.PNG" alt="Demo Application" /> <figcaption>Demo Application</figcaption> </figure> <p>The generateRandomString() function will generate random strings from the “characters” constant and the “encryptValue()” function will take three variables, which includes “value”, “key”, and “iv” to perform encryption process.</p> <figure> <img src="/api-decrypt/img1.PNG" alt="JavaScript Function" /> <figcaption>JavaScript Function</figcaption> </figure> <p>The following snippet shows that “loginData” constant containing “username” and “password” variable will be encrypted with the “encryptValue()” function as the value, and will grab the “key” and “iv” from the randomly generated strings.</p> <figure> <img src="/api-decrypt/img2.PNG" alt="API Encryption" /> <figcaption>API Encryption</figcaption> </figure> <p>Here, we can see the end result of the encryption process.</p> <figure> <img src="/api-decrypt/img4.PNG" alt="Encrypted Request" /> <figcaption>Encrypted Request</figcaption> </figure> <h3 id="how-do-we-decrypt-and-manipulate-the-api-request-then"> <a href="#how-do-we-decrypt-and-manipulate-the-api-request-then" class="anchor-head"></a> How do we decrypt and manipulate the API request then? </h3> <p>On the web application, we can send an example request to submit our credential with “foo” username and “foo” password.</p> <figure> <img src="/api-decrypt/img3.PNG" alt="Example Request" /> <figcaption>Example Request</figcaption> </figure> <p>Here, we can set a breakpoint in the web browser debugger, enabling us to manipulate the data, even if it is not being entered through user input. We will then change the username from “foo” to “bar” for demonstration purposes.</p> <figure> <img src="/api-decrypt/img5.PNG" alt="Request Parameter Manipulation" /> <figcaption>Request Parameter Manipulation</figcaption> </figure> <p>We then can grab the randomly generated IV and Key by setting a breakpoint on the encryption function where it is being called.</p> <p>IV=rq1vLGpUYj8MUzQo and Key=DZs88qaQ6kzUYbZZ</p> <figure> <img src="/api-decrypt/img6.PNG" alt="IV and Key" /> <figcaption>IV and Key</figcaption> </figure> <p>Here is now our newly generated encrypted body request.</p> <figure> <img src="/api-decrypt/img7.PNG" alt="Encrypted Request" /> <figcaption>Encrypted Request</figcaption> </figure> <p>As we know the IV and Key from our previous step, we can decrypt the payload with any online <a href="https://www.devglan.com/online-tools/aes-encryption-decryption">AES decryptor</a>.</p> <figure> <img src="/api-decrypt/img8.PNG" alt="Decrypted Request" /> <figcaption>Decrypted Request</figcaption> </figure> <p>Now we have successfully learned how to decrypt and manipulate encrypted API request.</p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/root-detection-evasion/" > <div class="nav-arrow">Previous</div> <span class="post-title">Android Root Detection Evasion</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="https://www.linkedin.com/in/williamtirtadjaja/">linkedin</a> <a class="footer_item" href="javascript::void(0)">resume</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2025</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
